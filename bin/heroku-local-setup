#!/usr/bin/env bash
set -ex

# https://devcenter.heroku.com/articles/heroku-postgresql#local-setup
dropdb namubufferi-local-test
createdb namubufferi-local-test

# https://devcenter.heroku.com/articles/heroku-local#set-up-your-local-environment-variables 
heroku config:get SENDGRID_PASSWORD -s  >> .env
heroku config:get SENDGRID_USERNAME -s  >> .env

pip install virtualenv
virtualenv venv --clear
source venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt

python manage.py migrate
python manage.py loadtestdata namubufferiapp.Category:5
python manage.py loadtestdata namubufferiapp.Product:30
python manage.py createsuperuser
